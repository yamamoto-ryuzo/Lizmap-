[1.仮想環境の設定](https://github.com/yamamoto-ryuzo/Lizmap-installation-Japanese-memo/blob/main/1.%E4%BB%AE%E6%83%B3%E7%92%B0%E5%A2%83%E3%81%AE%E8%A8%AD%E5%AE%9A.md)  

### 2.WEB環境の構築  Apache
#### 2-1.Apache　サーバーの構築  
（step1）   
sudo su  
sudo apt -y update  
sudo apt -y install apache2 libapache2-mod-fcgid  
sudo ufw app list  

（step2）LizmapWebClient3.6はHP8.1対応  
sudo add-apt-repository -y ppa:ondrej/php  
sudo apt -y update  
sudo apt -y install php8.1  

（step3）  
sudo apt -y search php8.1-*  
sudo apt-get  -y install php8.1-fpm php8.1-cli php8.1-bz2 php8.1-curl php8.1-gd php8.1-intl php8.1-mbstring php8.1-pgsql php8.1-sqlite3 php8.1-xml php8.1-ldap  

（step4）php8.1-json を明示する必要があるよう  
sudo apt-get -y  install libapache2-mod-php8.1  

#### 2-2.Webminをインストール  
（step1）  
sudo apt -y update  
sudo nano /etc/apt/sources.list  

（step2）  
下記をファイルに追加  
deb http://download.webmin.com/download/repository sarge contrib  

（step3）  
wget -q -O- http://www.webmin.com/jcameron-key.asc | sudo apt-key add  
sudo apt -y update  
sudo apt -y install webmin  

（step4）ファイアウォールを設定  
sudo ufw allow 10000  
 
#### 2-3. Encrypt（SSL）導入  
（SSLをインストール）  
sudo a2enmod ssl  
sudo a2ensite default-ssl  
sudo service apache2 restart  

（Install Certbot Snap）  
sudo snap install core  
sudo snap refresh core  
sudo apt -y remove certbot  

sudo apt -y install certbot

（Install Certificates from Let's Encrypt）  
sudo certbot certonly --webroot -w /var/www/html -d lizmap.yamakun.net  

いろいろ聞かれるので入力！  

認証の有効期限が切れないようにタイマー設定  
sudo systemctl status certbot.timer  
sudo systemctl list-timers certbot.timer --no-pager  

参考までに手動での更新は  
sudo certbot renew  


#### 2-4.Webminを利用  

https:// server-ip:10000/  
でアクセスすると安全ではないといわれるが無視！して接続する。  
 ![image006](https://user-images.githubusercontent.com/86514652/174401813-5b4ad211-2ab1-4c3e-8561-def64ac9dc9e.png)


そもそもrootパスワード設定した記憶がない・・・  

sudo su  
passwd  

でパスワードを設定，ちなみに画面表示がないが，入力は正常に動作しているので気にせず２回入力する。  
Username:root　　Password：設定したパスワード  
![image](https://user-images.githubusercontent.com/86514652/210163944-832dad2b-dc91-449b-8b4e-53a6b2b1e5ea.png)  


ここまでくればあとは簡単！  
一応日本語化までを説明  
・「Change Language and Theme」をクリック  
 ![image007](https://user-images.githubusercontent.com/86514652/174401866-f894dd5f-7a7e-4603-aeaa-8b341c0fa5b2.png)

・「WebminConfiguration」＞「language and Locale」で「日本語」を選択  
 ![image008](https://user-images.githubusercontent.com/86514652/174401898-b4c0e7ba-6c11-4ecd-bef9-b44090cb1513.png)


完成です！  
システム時間を　「Asia/Tokyo」になっているかは再度確認。  
なっていないと，おや～～と思うことが発生します。  
 ![image009](https://user-images.githubusercontent.com/86514652/174401933-8c65d0f4-552d-4329-835b-71c0f68d8162.png)

 
#### 2-5.ProFTPDの設定  

Webminよりインストール  
　未使用のモジュール　＞　ProFTPDサーバー　＞　InstallNow　　＞　InstallNow  

　 ![image010](https://user-images.githubusercontent.com/86514652/174402087-56c59192-f77b-4e48-a2f0-fb2fadd5e23c.png)


　サーバー　＞　ProFTPDサーバー　＞　各種設定が可能となっている  
 ![image011](https://user-images.githubusercontent.com/86514652/174402121-77a4c827-d239-46cd-92c9-3372b14e35f9.png)

ユーザーを作成  
　システム　＞　ユーザーおよびグループ  
　新しいユーザーを作成　＞　ユーザー名を「lizmapcloud」と入力  
　　　　　　　　　　　　　　ホームディレクトリ「/var/www/lizmap/lizmapcloud」  
　　　　　　　　　　　　　　パスワード「任意に入力」  
所属するグループ-既存グループから「www-data」を選択  
　　　　　　　　　　　　＞作成  

[3.QGISサーバーの設定](https://github.com/yamamoto-ryuzo/Lizmap-installation-Japanese-memo/blob/main/3.QGIS%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AE%E8%A8%AD%E5%AE%9A.md)  
