**ChatGPT3.5による日本語翻訳及びマークダウン生成**
# Changelog Lizmap 3.7

## Unreleased

## 3.7.0 - 2023-12-13

### Added
- Lizmap Web Clientの新しいテーマの追加
- Dataviz
  - ポップアップ内でプロットを表示する際にポップアップタイトルを使用する
  - プロットをレイヤーフィルタでフィルタリングしないための新しいオプション "trigger filter" の尊重
  - ウェブインターフェースでプロットがどのように配置されるかをエディタが設定できるようになりました。LizmapプラグインDatavizタブに新しいDrag & Dropレイアウトタブが追加され、フォームのようにタブとグループを作成できます。
- レジェンド
  - レイヤー内の一部のシンボルを有効/無効にするためのチェックボックスの追加
  - すべてのレイヤーとレンダリングルールのデフォルトのレジェンドアイテムの追加
  - デフォルトの背景色を表示するためにプロジェクトの背景色をグループ化
  - レガシーキーワードosm-mapnikなどの使用が非推奨となり、任意のベースレイヤーを背景として使用できます。新しい背景レイヤーはbaselayersという名前のグループ内に配置する必要があります。
- "QGISテーマ"機能の改善
- 編集
  - 1対n関係の改善されたユーザーエクスペリエンス：関連する子レイヤーのデータテーブルは、QGIS編集のドラッグ＆ドロップデザイナーで構成された位置を尊重するようになりました。
  - ポップアップにコンボボックスを追加して、関連するレイヤーの子フィーチャを新しく作成できるようになりました。これにより、親のポップアップから直接子フィーチャを作成できます。
  - 新しいジオメトリを追加する際の距離、角度などの制約の追加
  - ジオメトリを貼り付けるボタンの追加
- ドローイングツール
  - マップ上での測定結果の新しい表示
  - フィーチャの色を個別に設定
  - 個別にフィーチャを削除
  - マップキャンバスにテキストを描画
  - 回転
  - スケーリング
- フォームフィルタ：日付の場合と同様に、数値タイプに対しても2つ目のフィールドを使用できるようになりました。これは、レイヤーフィーチャが同じプロパティの最小値と最大値を記述する2つのフィールドを含む場合に便利です。
- アクションモジュール
  - プロジェクトおよびレイヤースコープの新しいサポート：アクションはポップアップ外、特定の選択したレイヤー、または汎用プロジェクトアクションとして使用できるようになりました。
  - 新しいウェブコンポーネント<lizmap-action-selector>を使用して、ユーザーがアクションを選択して実行できるようになりました（レイヤーおよびプロジェクトスコープ用）。
  - 新しいドックが利用可能で、プロジェクトアクションのリストを表示し、アクションを実行するボタンと結果をリセットする別のボタンが表示されます。
  - アクションが設定されたレイヤーに対しては、レジェンド内のレイヤーをクリックするとアクションセレクタとボタンが表示され、このレイヤーアクションを実行できます。
  - ポップアップアクションボタンの背景としてブートストラップアイコンの代わりにSVGアイコンを使用できます。
  - 現在のマップ範囲とマップ中心がWKT形式（投影EPSG:4326）でパラメータとして送信され、PostgreSQL関数で使用できます。
  - アクションは外部JavaScriptスクリプトから実行できます。例えば：
  ```javascript
  // アクションの実行
  lizMap.mainLizmap.action.runLizmapAction(actionName, scope = 'feature', layerId = null, featureId = null, wkt = null);
  // アクションのリセット
  lizMap.mainLizmap.action.resetLizmapAction()
  これにより、渡されたWKTジオメトリを使用してPostgreSQLアクションからデータを取得するなど、ジオメトリを送信できます。
  - JavaScriptおよびHTMLコードが近代化されました（jQueryの呼び出しは不要、ウェブコンポーネントの使用など）。
- パーマリンク機能の見直し
  - マップをパンやズーム、レイヤーのチェック/チェック解除などを行うと、URLが自動的に更新されるようになりました。
- 印刷設定
  - 各レイアウトに対して以下を設定できます：
    - 有効/無効
    - 許可されるグループ
    - フォーマットとデフォルト設定
    - DPIとデフォルト設定
    - フィーチャのポップアップ内のQGISアトラスレイアウトにカスタムアイコンを設定
- 新しい印刷ユーザーインターフェース
  - 印刷エリアがマップ上にマスクとして表示されるようになりました
  - 高度なパネルが以下を設定できるようになりました：
    - グリッドのX/Yパラメータを設定
    - メインマップの回転を設定
    - DPIを設定
- マップ上にMGRS座標を表示するサポート（@mind84からの貢献）
- Webdav添付ファイルウィジェットのサポート
  - Lizmap Web ClientからWebdavサーバーにファイルをアップロードおよび削除
  - Lizmapポップアップ内でWebdavサーバーに保存されたファイルを表示
- "プロジェクト"の代わりにランディングページにカスタムタイトルを設定できるようになりました
- ランディングページでフッターにコンテンツを追加できるようになりました（管理インターフェースで設定）

### Login
- 新しいパスワードセキュリティチェッカーの追加
- メールアドレスでログインするオプションの追加

### Changed
- デフォルトのプロジェクトイメージを複数回ダウンロードしないように変更。これにより、プロジェクトページの最初の読み込みが改善されました。
- Lizmap編集フォームフィールドの設定を変更し、自動補完で公開されたLizmap編集フォームフィールドの設定に遅延（300ms）を追加してサーバーへのリクエストの数を減らし、3文字以上の最小文字数をトリガーとして追加し、検索がアクセントに対して無関心になるように変更されました。

### Deprecated
- AtlasPrint QGISサーバープラグインは削除されるべきです。もはや使用されていません。
- osm-mapnik、ign-photo、google-satelliteなどという名前のレイヤーは非推奨とされました。これらの"レガシー"レイヤーに関するドキュメントを参照してください。

### Fixed
- 埋め込みレイヤーのキャッシングに誤ったキーが使用されているという誤植の修正（@mind84からの貢献）
- WMSレイヤーのデフォルトスタイルの選択の修正
- Lizmapアトラスで、名前にアクセントやスペースがある場合のポップアップの修正
- パーマリンクに誤ったレイヤー名が含まれている場合にマップの読み込みをブロックしないように修正
- WMS GetFeatureInfoサービスのIおよびJパラメータを丸める修正（@mind84からの貢献）
- ポイントの代わりにラインストリングとポリゴンに対してのみ逆ジオメトリボタンを表示する修正
- ジオメトリを作成/編集する際に空間制約をチェックする修正
- QGISサーバーへのGetFeatureInfoおよびGetFilterTokenリクエストに関するエラーの修正
- レイヤー名ではなく親WMS名を使用してキャスケードレイヤーのフィルタを修正
- QGISレイアウトに関する最新の機能の修正：グループ許可、順序など
- エスケープされた二重引用符を持つサブクエリのテーブルを取得するための修正

### Removed
- OpenLayers 2に関する一部のコードの削除
- バックエンド
- Lizmap Web Clientの対象最小バージョンを3.4にアップグレード
- 多くのJavaScriptコードのクリーンアップ
- QGIS Server 2に関する古いコードの削除
- DockerイメージでPHP 8.1に切り替え
- Jelixのバージョン1.8.4
- いくつかのPHPパッケージの更新
- OpenLayersを8.2.0にアップデート
- proj4を2.9.2にアップデート
- Plotly.jsを2.16.3にアップデート
- いくつかのJavaScript依存関係のアップデート
- PHP 8を実行する際の一部のPHP通知の修正（@Antoviscomiからの貢献）

### Funders
- Faunalia、@mind84からのソースコードへの貢献
- Avignon
- Calvados
- Direction Départementale des Territoires et de la Mer de l’Hérault (DDTM 34)
- ICRC
- Geolab.re
- Le Grand Narbonne
- Parc naturel régional du Haut-Jura
- Tenergie
- Terre de Provence Agglomération

## 3.7.0-rc.1 - 2023-11-24

### Added
- Webdav添付ウィジェットのサポート（@mind84からの貢献）
  - Lizmap Web ClientからWebdavサーバーにファイルをアップロードおよび削除
  - Lizmapポップアップ内でWebdavサーバーに保存されたファイルを表示
- Dataviz：
  - ポップアップ内でプロットを表示する際にポップアップタイトルを使用する
  - レイヤーフィルタでプロットがフィルタリングされないように新しいオプション "trigger filter" を尊重

### Fixed
- レイヤープロパティで見つかった名前とリンクの欠落した属性の修正
- 埋め込みレイヤーのキャッシングに誤ったキーが使用されているという誤植の修正（@mind84からの貢献）
- Dataviz：オプション "レイヤーが表示されている場合に表示" の修正
- WMSレイヤーのデフォルトスタイルの選択の修正
- Lizmapアトラスで、名前にアクセントやスペースがある場合のポップアップの修正
- パーマリンクに誤ったレイヤー名が含まれている場合にマップの読み込みをブロックしないように修正
- WMS GetFeatureInfoサービスのIおよびJパラメータを丸める修正（@mind84からの貢献）
- ポップアップをクリックした際のマウススピナーの修正

### Changed
- Lizmap編集フォームフィールドの設定を変更し、自動補完で公開されたLizmap編集フォームフィールドの設定に遅延（300ms）を追加してサーバーへのリクエストの数を減らし、3文字以上の最小文字数をトリガーとして追加し、検索がアクセントに対して無関心になるように変更されました。

### Permalink
- 不透明度、スタイル、レイヤー名にカンマが含まれる場合の修正
- ミニドックの使用
- 使用されるハッシュの見直し

### Refactor
- ジオブックマーク機能の見直し
- マップの上にテキストを追加するUIの改善：回転、スケールなど
- ジオメトリの制約に関するUIの改善
- Javascriptイベントlizmapeditionfeaturecreatedおよびlizmapeditionfeaturemodified
- フランスIGNマッププロバイダのURLの更新

### Translations
- Transifexウェブサイトから翻訳された文字列の更新：
  - Lizmap Web Client
  - Jelix
  - バックエンド

### Removed
- OpenLayers 2に関する一部のコードの削除

### Funders
- WPD
- フランスのCalvados州
- フランスのVaucluse州
- Faunalia
- Avignon市
- Direction Départementale des Territoires et de la Mer de l’Hérault (DDTM 34)

## 3.7.0-beta.1 - 2023-10-13

### Added
- メインランディングページのフッターにコンテンツを追加できるようになりました（管理インターフェースで設定）
- 新しいパスワードセキュリティチェッカーの追加
- メールでログインするオプションの追加
- パーマリンク機能の見直し
- メールで認証するオプションの追加
- マップキャンバスにテキストを描画する機能の追加（回転、スケーリングなど）

### Changed
- ツリービュー：凡例アイテムのスケール依存の可視性
- メールでログインするためにデータベースのログイン長さを増加
- セキュリティ向上のため、パスワードの最小文字数は現在12文字です

### Fixed
- レイヤーにアクセントがある場合：
  - レイヤーのエクスポートの修正
  - マップからのフィルタリングされたフィーチャの表示を修正
  - Null可能なチェックボックスを持つ編集フォームの読み込みを修正
  - レイヤーリストに基づいてポップアップの順序を見直し
  - CRS変数に関するPHP通知の修正
  - レイヤーチェックがない場合にパーマリンクの生成を修正
  - プロジェクトに埋め込まれたレイヤーから関係を読み込むための修正
  - UI上部バーのホームページタイトルを修正
- ジオメトリを作成/編集する際に空間制約をチェックする修正
- QGISプリセット/テーマの可視性エラーの修正
- インストール時のLizmap Web Clientに関するチェックリストの改善
- データがない場合にポップアップで子プロットを表示しないように修正

### Deprecated
- AtlasPrint QGISサーバープラグインは削除されるべきです。もはや使用されていません。
- osm-mapnik、ign-photo、google-satelliteなどという名前のレイヤーは非推奨とされました。これらの"レガシー"レイヤーに関するドキュメントを参照してください。

### Funders
- WPD
- フランスのCalvados州
- フランスのVaucluse州
- Faunalia

## 3.7.0-alpha.2 - 2023-08-28

### Fixed
- Lizmap CFGファイルで定義されたレイヤー名がある場合、レジェンド内のレイヤー名を使用する修正
- ポップアップからの編集の後、WMSレイヤーをリフレッシュする修正
- 新しいレジェンドに関するいくつかのリグレッションの修正：
  - オプション "レイヤーとしてグループ化"
  - 外部レイヤー
  - QGISコントロールの描画順序を処理
- Lizmap CFGファイルでスケールが0かどうかをチェックする修正
- モバイルで"locate by layer"セレクターが選択解除された場合にレイヤータイトルを表示する修正
- OpenTopoMapのサポート
- ポップアップからの編集の後、WMSレイヤーをリフレッシュする修正
- QGISプリセット/テーマの可視性エラーの修正
- 埋め込みレイヤーのプロジェクトへの関連を読み込む修正
- Lizmap Web Clientに関するインストールチェックリストの改善

### Changed
- レジェンドのグループに関連するキーワードは大文字と小文字を区別しないように変更

### Removed
- OpenLayers 2に関する一部のコードの削除

### Backend
- OpenLayersをバージョン7.5.1にアップグレード
- PHP 8を実行する際の一部のPHP通知の修正（@Antoviscomiからの貢献）

### Translations
- Transifexウェブサイトから翻訳された文字列の更新：
  - Lizmap Web Client
  - Jelix

## 3.7.0-alpha.1 - 2023-07-25

### Added
- レジェンドのリファクタリング：
  - レイヤー内の一部のシンボルを有効/無効にするためのチェックボックスの追加
  - レンダリングルールのすべてのレイヤーおよびシンボルにデフォルトのレジェンドアイテムを追加
  - デフォルトの背景色を表示するためにプロジェクトバックグラウンドカラーをグループ化
  - レガシーキーワードosm-mapnikなどの代わりに、どのベースレイヤーでも使用可能
  - これらの新しい背景レイヤーはbaselayersという名前のグループに配置する必要があります
- "QGISテーマ"の改善
- 編集機能：1-nリレーションでの
  - 関連する子レイヤーのデータテーブルは、QGIS編集のドラッグ＆ドロップデザイナーで設定された位置を尊重
  - ポップアップにコンボボックスを追加して、関連レイヤーの新しい子フィーチャを作成できるようにする。これにより、親ポップアップから直接子フィーチャを作成できます。
  - 新しいジオメトリを追加する際の制約の追加：距離、角度
  - ジオメトリを貼り付けるボタンの追加
- 描画ツール
  - マップ上での測定の新しい表示方法
  - フィーチャの色を個別に設定
  - フィーチャを個別に削除
  - マップキャンバスにテキストを描画
  - 回転
  - スケーリング
- フォームフィルタ：日付の場合と同様に、数値タイプの2番目のフィールドを使用できるように変更。これは、レイヤーフィーチャが同じプロパティの最小値と最大値を記述する2つのフィールドを含む場合に便利です。
- アクションモジュール
  - プロジェクトおよびレイヤースコープの新しいサポート：アクションはポップアップ外、特定の選択したレイヤー、または一般的なプロジェクトアクションとして使用できるようになりました。
  - ユーザーがアクションを選択して実行できる新しいWebコンポーネント <lizmap-action-selector> が使用されています（レイヤーおよびプロジェクトスコープ用）
  - 新しいドックが利用可能で、プロジェクトアクションのリストを表示し、アクションを実行するためのボタンと結果をリセットするための別のボタンが表示されます。
  - アクションが構成されたレイヤーについて、レジェンドでレイヤーをクリックすると、アクションセレクタとボタンが表示され、このレイヤーアクションを実行できます。
  - ポップアップアクションボタンの背景としてブートストラップアイコンの代わりにSVGアイコンを使用できます。
  - 現在のマップ範囲とマップ中心はWKT形式（投影EPSG:4326）でパラメータとして送信され、PostgreSQL関数で使用できます。
  - アクションは外部JavaScriptスクリプトから実行できます。例：
    ```javascript
    // アクションを実行
    lizMap.mainLizmap.action.runLizmapAction(actionName, scope = 'feature', layerId = null, featureId = null, wkt = null);
    // アクションをリセット
    lizMap.mainLizmap.action.resetLizmapAction()
    ```
  - EPSG:4326でのWKTも追加のパラメータとして送信できます。これはJavaScriptでアクションを実行する場合にのみ可能で、PostgreSQLアクションでこの渡されたWKTジオメトリを交差する別のテーブルからデータを取得するために使用できます。
  - JavaScriptおよびHTMLコードが近代化されました（jQuery呼び出しは不要、Webコンポーネントの使用など）
- データ可視化エディタがウェブインターフェース内でプロットの構成を行うことができるようになりました。
- LizmapプラグインDatavizタブに新しいDrag & Dropレイアウトタブが追加され、フォームの作成と同様にタブとグループを作成できるようになりました。
- 新しい印刷設定。各レイアウトに対して、次のことができます：
  - 有効/無効にする
  - 許可されるグループを設定
  - フォーマットとデフォルトを設定
  - DPIを設定し、デフォルトを設定
  - フィーチャのポップアップ内でQGISアトラスレイアウトのカスタムアイコンを設定

### Changed
- デフォルトプロジェクトイメージを複数回ダウンロードしないように変更。これにより、プロジェクトページの最初の読み込みが向上します。
- ホームページのタイトル設定の更新

### Updated
- 新しい描画ツールバー、OpenLayers 2からOpenLayers 6への移行
- Plotly.jsを2.16.3にアップデート
- proj4ライブラリのアップデート

### Translations
- Transifexウェブサイトから翻訳された文字列の更新

### Deprecated
- AtlasPrint QGIS
  サーバープラグインは削除されるべきです。もはや使用されていません。
- osm-mapnik、ign-photo、google-satelliteなどの名前のレイヤーは非推奨とされました。これらの「レガシー」レイヤーに関するドキュメントを参照してください。

### Backend
- 多くのJavaScriptコードのクリーンアップ
- いくつかのJavaScript依存関係の更新
- QGIS Server 2に関する古いコードの一部の削除
- OpenLayersライブラリをバージョン7.3.0にアップデート
- Dockerで展開した際のいくつかの問題の修正
- DockerイメージでPHP 8.1に切り替え
- Lizmap Web Clientの最小バージョンを3.4にアップグレード

### Funders
- Avignon
- Calvados（フランス）
- ICRC（国際赤十字委員会）
- Geolab.re
- Le Grand Narbonne
- Parc naturel régional du Haut-Jura
- Tenergie
- Terre de Provence Agglomération
