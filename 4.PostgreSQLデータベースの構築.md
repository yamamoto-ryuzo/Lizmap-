[3.QGISサーバーの設定.md](https://github.com/yamamoto-ryuzo/Lizmap-installation-Japanese-memo/blob/main/3.QGIS%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AE%E8%A8%AD%E5%AE%9A.md)  

### 4.PostgreSQLデータベースの構築  
#### 4-1.PostgreSQLデータベースのインストール  
Webminよりインストール  
　未使用のモジュール　＞　PostgreSQLデータベースサーバー  
　＞　InstallNow　　＞　InstallNow  
#### 4-2.postgresアカウントのパスワード設定  
Webminよりインストール  

　サーバー　＞　PostgreSQLデータベースサーバー　＞　PostgreSQLユーザー  
　＞　ユーザー名：postgresを選択　＞　パスワード設定　＞　保存  
#### 4-3.lizmap追加アカウントの設定  
Webminより設定  

　サーバー　＞　PostgreSQLデータベースサーバー　＞　PostgreSQLユーザー  
　　　　　　＞　新規ユーザーを作成  
　＞　ユーザー名：lizmap，パスワード設定，データベースの作成を可能を選択  

 ![image013](https://user-images.githubusercontent.com/86514652/174402386-07d92c7a-2862-4c68-9e72-e52c793147db.png)

 ![image014](https://user-images.githubusercontent.com/86514652/174402420-495a3589-f06d-4c96-bbfa-35e9acbf1cbd.png)

#### 4-4.Lizmapデータベースの作成  
Webminよりインストール  
　サーバー　＞　PostgreSQLデータベースサーバー　＞　新規データベースを作成  
　　　　　　＞　データベース名，オーナー：Lizmap　＞　作成  
 ![image015](https://user-images.githubusercontent.com/86514652/174402454-3fb0cb71-bca5-4680-8188-436b8c759552.png)

 
#### 4-5.設定ファイルの編集  
##### UBUNTU	/etc/postgresql/VERSION/main/postgresql.conf  
　に　listen_addresses = '*'　を追加  
　　　max_connections = 1000　に修正  
![image](https://user-images.githubusercontent.com/86514652/210170140-b7011381-2ce2-4c81-8c76-8be51a7abc65.png)  

(保留中)
##### UBUNTU	/etc/postgresql/VERSION/main/pg_hba.conf　を下記に書き換え  

local	all all 							trust  
host	all all 127.0.0.1	255.255.255.255	md5  
host	all all 0.0.0.0/0					md5  
host	all all ::1/128						md5  
hostssl all all 127.0.0.1	255.255.255.255	md5  
hostssl all all 0.0.0.0/0					md5  
hostssl all all ::1/128						md5  

#### 4-6.PostGIS等拡張機能のインストール  
[pgAdmin](https://www.pgadmin.org/)よりインストール 

sudo apt -y update  
sudo apt -y install postgis postgresql-14-postgis-3  

　ログインは　postgres：スーパーユーザーで行う必要あり  
　拡張　を　右クリック　＞　作成　＞　拡張　＞「postgis」を選択　＞保存  
　　　　　　　　　　　　　　　　　　　　　　＞「pg_trgm」を選択　＞保存  
  　　　　　　　　　　　　　　　　　　　　　＞「unaccent」を選択　＞保存  
「pg_trgm」「unaccent」はLizmapの検索機能で必要です。  

![image017](https://user-images.githubusercontent.com/86514652/174402540-0143fc31-e084-4edc-ae6b-be757b00ba1c.png)

[5-1.Lizmap Web Clientのインストール](https://github.com/yamamoto-ryuzo/Lizmap-installation-Japanese-memo/blob/main/5.Lizmap%20Web%20Client%E3%81%AE%E8%A8%AD%E5%AE%9A/5-1%20.Lizmap%20Web%20Client%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB.md)  
